<!doctype html>
<html>

<head>
	<script id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="6a06e0ff-3af4-42b9-ab66-dd32f9e600e0"
		data-blockingmode="auto" type="text/javascript"></script>
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-SXLQTMF14Q"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag() { dataLayer.push(arguments); }
		gtag('js', new Date());

		gtag('config', 'G-SXLQTMF14Q');
	</script>
	<!-- Google Tag Manager -->
	<script type="915998925114be6a38098363-text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                })(window,document,'script','dataLayer','GTM-MQMRMNL5');</script>
	<!-- End Google Tag Manager -->
		<!-- Clarity tracking code for https://greg.heffner.live/ --><script>    (function(c,l,a,r,i,t,y){        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i+"?ref=bwt";        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);    })(window, document, "clarity", "script", "nry25es3go");</script>
            <script type="text/javascript">
                (function(c,l,a,r,i,t,y){
                    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
                    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
                    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
                })(window, document, "clarity", "script", "nry25es3go");
            </script>
	<link rel="apple-touch-icon" sizes="180x180" href="/image/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/image/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/image/favicon-16x16.png">
	<link rel="manifest" href="/image/site.webmanifest">

	<style>
		* {
			box-sizing: border-box;
		}

		body {
			font-family: 'trebuchet ms', sans-serif;
			padding: 20px;
			background: #4E90BB;
		}

		.header {
			padding: 10px;
			font-size: 20px;
			text-align: center;
			background: white;
		}

		.leftcolumn {
			float: left;
			width: 75%;
			height: 90vh;
			overflow-y: visable;
		}

		.rightcolumn {
			float: left;
			width: 25%;
			padding-left: 20px;
		}

		.img {
			
			width: 100%;
			padding: 20px;
		}

		.card {
			background-color: white;
			padding: 20px;
			margin-top: 20px;
		}

		.row:after {
			content: "";
			display: table;
			clear: both;
		}

		.footer {
			padding: 20px;
			text-align: center;
			background: #ddd;
			margin-top: 20px;
		}

		@media screen and (max-width: 800px) {

			.leftcolumn,
			.rightcolumn {
				width: 100%;
				padding: 0;
			}
		}

		.navbar {
			display: flex;
			justify-content: flex-end;
			width: 100%;
			background-color: black !important;
			font-family: 'trebuchet ms', sans-serif;
			padding-right: 15px;
			padding-left: 15px;
		}

		.navdiv {
			display: flex;
			align-items: center;
			justify-content: space-between;
		}

		.navbar button {
			background-color: transparent;
			margin-left: 10px;
			border-radius: 10px;
			padding: 10px;
			width: 90px;
		}

		.navbar button a {
			color: transparent;
			font-weight: bold;
			font-size: 15px;
		}

		.navbar li {
			list-style: none;
			display: inline-block;
		}

		.navbar li a {
			color: white;
			font-size: 18px;
			font-weight: bold;
			margin-right: 25px;
			font-family: 'trebuchet ms', sans-serif;
		}

		.navbar button {
			background-color: black;
			margin-left: 10px;
			border-radius: 10px;
			padding: 10px;
			width: 90px;
		}

		.navbar button a {
			color: white;
			font-weight: bold;
			font-size: 15px;
			font-family: 'trebuchet ms', sans-serif;
		}
		.scrollcard {
			height: 200px; 
			overflow: hidden; 
			position: relative;
			background-color: white; 
			padding: 20px;
			margin-top: 20px; 
		}

		.scroll-container {
			height: calc(100% - 40px); 
			overflow: hidden; 
			position: relative;
		}

		.scroll-container nav {
			position: absolute;
			top: 0;
			width: 100%; 
			animation: scroll 20s linear infinite; 
		}

		@keyframes scroll {
			0% {
				top: 100%;
			}
			100% {
				top: -100%;
			}
		}
	</style>

	<meta name="title" content="Nerdsense - Kubernetes - Aug 2024">
	<meta name="description" content="86 the Prime Rib">
	<meta name="keywords" content="kubernetes, k8s, lens, k9s, trivy, nginx, load balance, ingress, cloudflare, tunnel">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="language" content="English">
	<meta http-equiv='content-language' content='en-gb'>
	<meta name="author" content="Greg Heffner">
	
	<title>Nerdsense - Kubernetes - Aug 2024</title>
	
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3941951641805897"
		crossorigin="anonymous"></script>

	<script async src="https://fundingchoicesmessages.google.com/i/pub-3941951641805897?ers=1"
		nonce="drPCtL_hPnvLGFPUGtHsFQ" type="915998925114be6a38098363-text/javascript"></script>
	<script nonce="drPCtL_hPnvLGFPUGtHsFQ" type="915998925114be6a38098363-text/javascript"> (function() {
              function signalGooglefcPresent() {
                  if (!window.frames['googlefcPresent']) {
                      if (document.body) {
                          const iframe = document.createElement('iframe');
                          iframe.style = 'width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;';
                          iframe.style.display = 'none';
                          iframe.name = 'googlefcPresent';
                          document.body.appendChild(iframe);
                      } else {
                          setTimeout(signalGooglefcPresent, 0);
                      }
                  }
              }
              signalGooglefcPresent();
          })();  
          </script>
</head>

<body>
	<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MQMRMNL5" height="0" width="0"
			style="display:none;visibility:hidden"></iframe></noscript>
	<!-- End Google Tag Manager (noscript) -->
	<nav class="navbar">
		<div class="navdiv">
			<ul>
				<li><a href="https://greg.heffner.live">Home</a></li>
				<li><a href="https://greg.heffner.live/photos.html">Photos</a></li>
				<li><a href="https://greg.heffner.live/blog.html">Blog</a></li>
				<li><a
						href="https://www.paypal.com/donate/?business=UK9DCMKFRTWRN&no_recurring=0&item_name=Thanks+for+supporting+the+page&currency_code=USD">Support</a>
				<li><a href="https://greg.heffner.live/privacy.html">Privacy Policy</a></li>
				<li><a href="https://greg.heffner.live/cookie.html">Cookie Policy</a></li>
				<li><a href="/cdn-cgi/l/email-protection#c1aca0a8afefb1ada0aff4f6f9f281a7a0b2b5aca0a8adefa2aeac">Contact</a>
				</li>
			</ul>
		</div>
	</nav>
	<div class="header">
		<h2>Nerdsense</h2>
	</div>
	<div class="row">
		<div class="leftcolumn">
			<div class="card">
				<h1>Kubernetes: 86 the Prime Rib</h1>
				<h5>Greg Heffner August 4, 2024</h5>
				
				<img src="/image/blog/2024/Aug/k8s.png" alt="Load Balancing" style="display: block; margin-left: auto; margin-right: auto; width: 45%; height: auto;">
				<br>
				<br>		

                <p>When a docker image starts it is expected to work until someone turns it off. BUT... What if the docker image runs
                    out of resources? What if the docker image is over-utilized by traffic? What if the docker host crashes? These are
                    all real questions that have to be thought through when hosting a dockerized application. </p>
                
                <p>Kubernetes or K8s comes from the Greek word for helmsman or pilot. K8s name is derived from the 8 letters between the K and the S.
                    This website you are on right now lives in a K8s cluster. Check out my write-up I have in github about how I built it <a
                        href="https://github.com/gregheffner/k8-nginx-webpage">k8-nginx-webpage</a>. </p>
                
                <p>My first job I had as a teen was in a kitchen. There was a schedule posted at work in the same place every week letting
                    everyone know where to go and when to show up. If someone needed to be off work, needed to leave early, wanted to
                    switch roles, they huddled around the schedule and worked it out and wrote it down for everyone to see the changes. Sometimes schedule changes had to be approved. When I worked there, 
					I was the best fry guy these old guys ever seen in their life, so that meant I never got to do the fun jobs. They needed my skills too much on them Combo Apps. 
					¬Ø\_(„ÉÑ)_/¬Ø All kidding aside there had to be a schedule to be successful. We needed to have the correct amount of people and resources to be able to handle the rush otherwise they would go somewhere else. </p>
                
                <p>When a ticket is printed the expo calls
                    out what is needed from all the stations for the order. For example, if there was a order for two guests, one salad
                    order and one well done steak order, those orders would take two way different times to prepare and two different routes to
                    be plated. The expo person needs to know who gets the salad order and who gets the grill order to make sure the
                    orders go to the correct place. You may need more than one employee working a station though if you expect a lot of work that shift, it would be set-up in the schedule though. </p>
                
				<h3>How does it work</h3>
                
				<p>K8s schedules the deployment and its pods the same way a restaurant schedules its employees for the kitchen. In this blogs example there is a 3
                    node K8s cluster consisting of one primary and two worker nodes for high availability and redundancy. </p>

                <p>The primary or scheduler node contains all the details of a deployment. Its jobs is to be the point of reference. Think of the primary node as the expo person in the kitchen. 
					 The primary node knows the number of pods or docker images
                    needed, the amount of nodes needed to host the pods, and the ingress and egress traffic
                    routing settings for the deployment. The worker nodes do not need this. They have just what they need to be connected in a cluster and they know who the primary node is and how to get information. All
                    other resources from the worker nodes are applied to an available pool for use with the remaining resources from the
                    primary node. Think of nodes as the different kitchen stations in a restaurant. These stations are
                    responsible for types of services, grill, saute, salad, fry. Once everything is connected together a complete service can be provided. Soup to nuts.</p>
                
                <p>On each node are pods. Think of these pods like baskets containing
                    docker images. Pods can be moved from node to node based either
                    on predefined schedules or resource limits. Think of pods as the employees in the kitchen. There
                    might be one pod that does all the work or multiple pods to split the work. The number of pods needed depends on the schedule and the
                    resources available in the deployment. Just like a restaurant might have a employee thats better working day shift over night shift. </p>

					<figure>
						<img src="/image/blog/2024/Aug/nodes-pods.png" alt="nodes&pods"
							style="display: block; margin-left: auto; margin-right: auto; width: 50%; height: auto;">
						<figcaption style="text-align:center;"><a href="https://www.geeksforgeeks.org/kubernetes-node/#">Kubernetes Node and
								Pods</a> from GeeksforGeeks</figcaption>
					</figure>
                
                <h3>What are the benefits</h3>
                
                <p><strong>Redundancy- </strong>Normally if a host running a docker image fails or is unavailable, that docker image
                    running becomes unavailable until the host becomes available again. Setting up a deployment in a K8s cluster allows a node become unavailable and pods 
					will be automatically spun up on other nodes restoring services without any intervention. Once the node becomes available again and if a pod needs to 
					move then they can move to that node again. </p>
                
                <p><strong>High Availability- </strong>Imagine an influx of traffic that one docker image cant handle. All the traffic
                    past a certain point will be lost as resource unavailable or not found. K8s and its horizontal pod auto-scaler
                    service, can be set with thresholds on the amount of CPU or memory used before a new pod is spun up to support the
                    load. On. Its. Own. Having the ability to automatically add or remove resources based on use is very powerful.</p>
                
                <p><strong>Security- </strong>Setting up pod security standards and network policies allows an application to live in a isolated environment 
					from its host server and sets up encrypted pod to pod traffic between devices. Using cloudflared tunnels in addition to the k8s security standards drastically 
					improves application security as well without having to open up firewall ports. Check out <a
                        href="https://developers.cloudflare.com/cloudflare-one/tutorials/many-cfd-one-tunnel">cloudflared tunnels</a>
                    and how to route traffic for more info. For more info on k8s security, check out <a href="https://kubernetes.io/docs/concepts/security/">Kubernetes security
                        mechanisms</a> by kubernetes. </p>
            
                                    <br>
                                    <h3>Why you should use it</h3>
									<p>Wrapping all this up I highly recommend someone getting to know K8s. Even if it is just to learn how it works or to figure out how loadbalance your blog. 
										There are so many resources out there to help you learn and understand K8s.
									</p>
                                    <p>Some great examples of K8s in action are:</p>
                                    <ul>
                                        <li>This Blog you are reading, check out in github- <a href="https://github.com/gregheffner/k8-nginx-webpage">k8-nginx-webpage</a> and read about docker in my <a href="https://greg.heffner.live/image/pages/2024/July/DockerHub.html"> Blog here</a>.</li>
                                        <li><a href="https://spacelift.io/blog/kubernetes-use-cases">12 Kubernetes Use Cases</a> by
                                            Spacelift</li>
                                        <li><a href="https://www.youtube.com/watch?v=4ht22ReBjno">The Illustrated Children's Guide to
                                                Kubernetes</a> a video by Deis, Inc.</li>
                                        <li><a href="https://debora-piu.medium.com/explaining-kubernetes-with-a-real-life-example-from-chatgpt-b71be6452f89">Explaining
                                                Kubernetes with a real life example from ChatGPT</a></li>
									</ul><br>
                                    <p>There are some very interesting tools that can be used to maintain your clusters and in my case, a website. I have used these tools or still use these tools today for my cluster.</p>
																				<img src="/image/blog/2024/Aug/lens.png" alt="LensImg"
																					style="display: block; margin-left: auto; margin-right: auto; width: 75%; height: auto;">
																				<figcaption style="text-align:center;"><a href="https://docs.k8slens.dev">Lens</a> is great to have pulled up in the background or to watch when
																					patching. Check out this script I use <a
																						href="https://github.com/gregheffner/k8-patchNbounce">k8-patchNbounce</a></figcaption>
																			</figure>

																			<figure>
																				<img src="/image/blog/2024/Aug/k9s.png" alt="K9s img"
																					style="display: block; margin-left: auto; margin-right: auto; width: 75%; height: auto;">
																				<figcaption style="text-align:center;"><a href="https://k9scli.io">K9s</a> is great for logging or looking for 403 reasons. I like anything
																					pod level to use K9s.</figcaption>
																			</figure>

																			<figure>
																				
																				<img src="/image/blog/2024/Aug/locusts.png" alt="Locusts img"
																					style="display: block; margin-left: auto; margin-right: auto; width: 75%; height: auto;">
																				<figcaption style="text-align:center;">I use <a href="https://locust.io">Locust</a> for open
																					source site testing. I use it to trigger CPU, memory, and user loads to test autoscaling.</figcaption>
																			</figure>

																			<figure>
																				<img src="/image/blog/2024/Aug/trivy.png" alt="trivy img"
																					style="display: block; margin-left: auto; margin-right: auto; width: 75%; height: auto;">
																				<figcaption style="text-align:center;"><a href="https://aquasecurity.github.io/trivy/v0.28.1/">Trivy</a> is great for
																					vulnerability scanning. Ive never been an A student until now haha. Easy when trivy prints vulns and how
																					to fix them</figcaption>
																			</figure>



                                    </ul>
                                        <br>
                                    <h3><a href="https://www.bing.com">Bing AI</a> explanation</h3>
                
                                        <p>Let‚Äôs step into the bustling kitchen of a fancy restaurant, where technology and teamwork
                                            blend like the finest ingredients. üçΩÔ∏èüë®‚Äçüç≥</p>
                                        <p><strong>Kubernetes (Head Chef): </strong>Meet Chef Kube, the head chef! Chef Kube wears a
                                            tall hat (like a crown) and orchestrates the entire kitchen. Chef Kube knows every recipe,
                                            dietary preference, and allergy alert. When an order comes in, Chef Kube assigns tasks to
                                            sous-chefs (nodes) and ensures everything runs smoothly. üßë‚Äçüç≥</p>
                                        <p><strong>Nodes (Sous-Chefs): </strong>Sous-chefs (nodes) are the backbone of the kitchen. They
                                            handle specific tasks‚Äîgrilling, chopping, plating. Each sous-chef has their own cutting
                                            board (node) and knife (resources). Chef Kube ensures they collaborate seamlessly. üë©‚Äçüç≥üî™
                                        </p>
                                        <p><strong>Clusters (Kitchen Stations): </strong>The kitchen is divided into stations
                                            (clusters). Each station has a specialty: grill, saut√©, pastry, and more. Just like
                                            clusters, these stations work together to create a delightful dining experience. Some
                                            stations are physical (real stovetops), while others are virtual (oven simulations). üî•</p>
                                        <p><strong>Pods (Prep Teams): </strong>Imagine a team of sous-chefs working on a single dish.
                                            That‚Äôs a pod! They gather around, discussing flavors, adjusting spices, and plating
                                            garnishes. Each pod focuses on one dish, making sure it‚Äôs perfect. üåøüçΩÔ∏è</p>
                                        <p><strong>Containers (Dish Trays): </strong>Imagine the kitchen as a massive workstation. Each
                                            dish is like a container. It‚Äôs a perfectly plated masterpiece‚Äîmaybe a creamy risotto, a
                                            sizzling steak, or a vegan curry. These dishes (containers) are neatly arranged on trays,
                                            ready to be served. üç≤</p>
                                        <br>
                                        
                                        <p>In summary: <br>
                                            Containers are beautifully plated dishes. 
                                            Kubernetes is Chef Kube, orchestrating the kitchen.
                                            Clusters are specialized kitchen stations.
                                            Nodes are sous-chefs with their own cutting boards.
                                            Pods are prep teams creating culinary magic.
                                            Bon app√©tit, my little food explorer! üåüüç¥</p>
					

</div>
</div>
<div class="rightcolumn">
	<div class="card">
		<h3>About Me</h3>
		<p>I served in the U.S. Army, specializing in Network Switching Systems and was attached to a Patriot
			Missile
			System Battalion. After my deployment and Honorable discharge, I went to college in Jacksonville, FL
			for
			Computer Science. I have two beautiful and very intelligent daughters. I have more than 20 years
			professional IT
			experience. This page is made to learn and have
			fun. If
			its messed up, let me know. Im still learning :)</p>
	</div>
	<div class="scrollcard">
		<h3>Recent Blogs</h3>
		<div class="scroll-container">
			<nav>				
				<li><a href="https://greg.heffner.live/image/pages/2024/July/LB.html">Loadbalancing: Boots & Cats &</a></li>
				<li><a href="https://greg.heffner.live/image/pages/2024/July/DockerHub.html">DockerHub: Because Ship Happens</a></li>
				<li><a href="https://greg.heffner.live/image/pages/2024/July/VPNs.html">VPNs: Web browsing and IP masking</a></li>
				<li><a href="https://greg.heffner.live/image/pages/2024/July/thecloud.html">The Cloud: Not the Floridian Cumulonimbus kind</a></li>
				<li><a href="https://greg.heffner.live/image/pages/2024/July/wifi.html">WiFi: Wireless internet magic</a></li>
				<li><a href="https://greg.heffner.live/image/pages/2024/July/homebuild.html">A Home Build: If I were to build it today</a></li>
			</nav>
		</div>
	</div>
	<div class="card">
		<h3>Popular Projects</h3>
		<li><a href="https://github.com/gregheffner/k8-nginx-webpage">Kubernetes cluster build</a></li>
		<li><a href="https://github.com/gregheffner/python-init">CookieCutter Script - A python template</a>
		</li>
		<li><a href="https://github.com/gregheffner/playbooks/tree/main/tasks/">Ansible Kali Docker Build</a></li>
		<li><a href="https://github.com/gregheffner/playbooks/blob/main/tasks/k8reboot.yml">Ansible Kubernetes node
				bounce w/NGINX HA</a></li>
	</div>
	<div class="card">
		<h3>Book Board</h3>
		<li><a href="https://www.amazon.com/Phoenix-Project-DevOps-Helping-Business/dp/0988262592">The Phoenix
				Project:
				A Novel about IT, DevOps, and Helping Your Business Win</a></li>
		<li><a href="https://www.amazon.com/Algorithms-to-Live-By-audiobook/dp/B01D24NAL6/">Algorithms to Live
				By: The
				Computer Science of Human Decisions</a></li>
		<li><a href="https://www.ebay.com/itm/144165393633?">Little Lefty</a></li>
		<li><a href="https://www.amazon.com/Anniversary-Paperback-Volumes-Limited-Original/dp/1637990049/">Harry
				Potter</a>
		</li>
	</div>
	<div class="card">
		<h3>Weather Loop </h3>
		<a href="https://radar.weather.gov/ridge/standard/SOUTHEAST_loop.gif">
			<img border="3" src="https://radar.weather.gov/ridge/standard/SOUTHEAST_loop.gif"
				style="border: 1px solid FF0000; width: 300px;">
	</div>
</div>
</div>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>
<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js"
	data-cf-settings="f2199bb571cfda9c96d3d8cf-|49" defer></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015"
	integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ=="
	data-cf-beacon='{"rayId":"8a0c47bffe7b53f3","r":1,"version":"2024.4.1","token":"58654ca0c624448c9c52f5291ddf5bec"}'
	crossorigin="anonymous"></script>
</body>

</html>
